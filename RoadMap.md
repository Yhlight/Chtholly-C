# Chtholly 语言开发路线图

本项目旨在逐步实现 Chtholly 编程语言，最终目标是完成一个可以自举的编译器。开发过程将遵循测试驱动开发（TDD）原则，分为以下几个主要阶段。

## Phase 1: 编译器核心基础设施

此阶段的目标是搭建一个功能完备的编译器骨架，能够处理最简单的 Chtholly 代码，并将其转译为 C++。

- [x] **项目设置**
    - [x] 初始化 Git 仓库
    - [x] 创建 `src` 和 `tests` 目录结构
    - [x] 配置 CMake 构建系统 (`CMakeLists.txt`)
    - [x] 编写 Python 构建脚本 (`build.py`)
    - [x] 集成 GoogleTest 测试框架
- [x] **词法分析器 (Lexer)**
    - [x] 定义所有 `Token` 类型 (`Token.h`)
    - [x] 实现词法分析器，将源代码字符串转换为 `Token` 序列
        - [x] 单字符词法单元
        - [x] 双字符与多字符操作符
        - [x] 数字与字符串字面量
        - [x] 标识符与关键字
- [ ] **语法分析器 (Parser)**
    - [x] 定义抽象语法树（AST）节点 (`AST.h`)
        - [x] 表达式基类与访问者模式
        - [x] 字面量表达式 (`LiteralExpr`)
        - [x] 一元与二元表达式 (`UnaryExpr`, `BinaryExpr`)
    - [x] 实现递归下降解析器，将 `Token` 序列转换为 AST
        - [x] 字面量表达式
        - [x] 算术表达式 (处理优先级)
        - [x] 赋值表达式
        - [x] 语句
            - [x] 变量声明 (`let`, `mut`)
            - [x] `if` 语句
            - [x] `for` 循环
            - [x] 函数声明
- [x] **语义分析器 (Sema)**
    - [x] 实现符号表 (`SymbolTable.h/.cpp`) 用于作用域和变量跟踪
    - [x] 实现类型检查和语义分析逻辑 (`Sema.h/.cpp`)
        - [x] 变量声明与使用分析
        - [x] 类型推断与检查
 - [x] **代码生成器 (CodeGen)**
    - [x] 实现访问者模式，遍历 AST 并生成等效的 C++ 代码 (`CodeGen.h/.cpp`)

## Phase 2: 核心语言特性

在编译器骨架的基础上，逐步实现 Chtholly 的核心语法和功能。

- [ ] **变量和基本类型**
    - [ ] `let` 和 `mut` 变量声明
    - [ ] 类型推断与显式类型注解
    - [ ] 内置类型支持 (`int`, `double`, `char`, `string`, `bool`, `void`)
- [ ] **表达式和运算符**
    - [ ] 数学运算符 (`+`, `-`, `*`, `/`, `%`)
    - [ ] 逻辑和比较运算符 (`&&`, `||`, `!`, `==`, `!=`, `<`, `>`, `<=`, `>=`)
    - [ ] 赋值运算符 (`=`, `+=`, `-=`, etc.)
- [x] **控制流**
    - [x] `if`/`else` 条件语句
    - [ ] C-Style `for` 循环
    - [x] `switch`/`case` 语句 (支持 `fallthrough`)
- [x] **函数**
    - [x] 函数声明和调用 (`func`)
    - [x] 返回类型和参数列表
    - [x] Lambda 表达式

## Phase 3: 高级语言特性

实现 Chtholly 更具特色的高级功能，增强其表达能力。

- [x] **复合类型**
    - [x] `struct` 声明、实例化和成员访问
    - [ ] `enum` 声明和使用
    - [ ] `array` 类型（包括固定长度数组）
- [ ] **所有权系统**
    - [ ] 所有权转移 (move)
    - [ ] 不可变借用 (`&`)
    - [ ] 可变借用 (`&mut`)
    - [ ] `option<T>` 和 `none` 用于空值处理
- [ ] **模块化**
    - [ ] `import` 语句，支持文件和模块导入
- [ ] **泛型**
    - [ ] 泛型函数
    - [ ] 泛型结构体
    - [ ] Trait 和泛型约束 (`?`)

## Phase 4: 标准库与元编程

扩展语言的生态，提供标准库功能和元编程能力。

- [ ] **内置模块**
    - [ ] `iostream` (实现 `print` 函数)
    - [ ] `filesystem`
- [ ] **高级功能**
    - [ ] `operator` 模块与操作符重载
    - [ ] `reflect` 模块与静态反射
    - [ ] `meta` 模块与元编程
    - [ ] `util` 模块

## Phase 5: 自举

终极目标：使用 Chtholly 语言重写 Chtholly 编译器。

- [ ] **编译器重写**
- [ ] **扩展新语法特性**
